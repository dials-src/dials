Improvements to the underlying datastructures used in the scaling code
